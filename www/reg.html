<script type="text/javascript">
  $("document").ready(function() {
    $("#submitdk").on("click",function(e) {
      e.preventDefault();
      var mail = $("#email").val();
      var pass1 = $("#pass").val();
      var pass2 = $("#repass").val();
      var filter = /^[A-Za-z0-9]+([_\.\-]?[A-Za-z0-9])*@[A-Za-z0-9]+([\.\-]?[A-Za-z0-9]+)*(\.[A-Za-z]+)+$/;
      if (!mail || !pass1 || !pass2) {
        navigator.notification.alert("Vui lòng điền đầy đủ!");
      }
      else if (!filter.test(mail)) {
        navigator.notification.alert("Email không hợp lệ");
      }
      else if (pass1 != pass2) {
        navigator.notification.alert("Vui lòng nhập lại mật khẩu giống nhau");
      }
      else {
        $("body").append("<div id='mask'></div>");
        $.ajax({
            url: sv + "user.php",
            type: "POST",
            dataType: "json",
            data: "param=no",
            success: function(htmll){
               $("#mask").remove();
                dem = 0;
                jQuery.each(htmll, function(key, value) {
                   if(value.email == mail) {
                    dem++;
                    return false;
                   }

                });
                if(dem>0) {
                  navigator.notification.alert("Email đã được sử dụng, vui lòng chọn email khác");
                }
                else {
                       var form_viet = {submit: 'ok', email: mail,pass: pass1};
                  $.ajax({
                      type: "POST",               
                      url: sv + "reg.php",       
                      data: form_viet,            
                      success: function(result) { 
                          navigator.notification.alert("Đăng ký Thành công");
                          $("#loadcontent").load('login.html');
                      }
                  });
                  
                }
            }, error: function(e) {
                $("#mask").remove();
                navigator.notification.alert(e);
            }
        });
        //
      }
    });
  })
</script>


<div class="panel panel-primary">
  <div class="panel-heading">Đăng ký</div>
  <div class="panel-body">
    <form class="form-horizontal">
      <div class="form-group">
        <label for="inputEmail3" class="col-sm-2 control-label">Email</label>
        <div class="col-sm-10">
          <input type="email" class="form-control" id="email" placeholder="Email">
        </div>
      </div>
      <div class="form-group">
        <label for="inputPassword3" class="col-sm-2 control-label">Password</label>
        <div class="col-sm-10">
          <input type="password" class="form-control" id="pass" placeholder="Password">
        </div>
      </div>
      <div class="form-group">
        <label for="inputPassword3" class="col-sm-2 control-label">Re-Password</label>
        <div class="col-sm-10">
          <input type="password" class="form-control" id="repass" placeholder="Password">
        </div>
      </div>
      <div class="form-group">
        <div class="col-sm-offset-2 col-sm-10">
          <button id="submitdk" class="btn btn-primary">Đăng Ký</button>
        </div>
      </div>
    </form>
  </div>
</div>